<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ManagerEdu">
	<!-- 교육목록 -->
	<select id="EduList" parameterType="hashmap" resultType="com.es.manager.EduListDto">
		select b.name belong_name, l.edu_no, l.edu_name, c.edu_name edu_code_name, l.edu_schedule, l.manager, i.name instructor_name
		from education_list l, belong b, education_code c, instructor i
		where l.belong_no = b.belong_no and c.edu_code=l.edu_code and i.instructor_no=l.instructor_no
		limit #{startRow}, #{endRow}
	</select>
	<select id="EduListCount" parameterType="int" resultType="int">
		select count(*)
		from education_list
	</select>
	<select id="EduListDetail" parameterType="int" resultType="com.es.manager.EduListDto">
		select l.edu_no, l.belong_no, b.name as belong_name, l.edu_field, l.edu_code, c.edu_name as edu_code_name, l.edu_name, l.edu_target, l.manager, 
			l.edu_way, l.edu_schedule, l.edu_date, l.edu_location, l.instructor_no, l.budget, l.note, i.name as instructor_name, l.closing_date
		from education_list l, instructor i, education_detail detail, belong b, education_code c
		where l.edu_no=#{edu_no} and i.instructor_no = l.instructor_no and detail.edu_no = l.edu_no and b.belong_no = l.belong_no and c.edu_code = l.edu_code
	</select>
	<!-- 교육검색  -->
	<select id="searchAll" resultType="com.es.manager.EduListDto" parameterType="hashmap">
		select * from education_list
		<include refid="search"></include>
	</select>
	<sql id="search">
		<choose>
		<when test="searchOption == 'all'">
			where belong_no like '%'||#{keyword}||'%'
			or title like '%'||#{keyword}||'%'
			or content like '%'||#{keyword}||'%'
		</when> 
		<otherwise>
			where ${searchOption} like '%'||#{keyword}||'%'
		</otherwise>
		</choose>
	</sql>
	<!-- 교육심사 -->
	<!-- 교육등록 -->
</mapper>